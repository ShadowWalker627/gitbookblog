# 浏览器重绘与重排的区别？

[重绘与重排](https://juejin.cn/post/6844904083212468238)

* 重排/回流（Reflow）：当DOM的变化影响了元素的几何信息，浏览器需要重新计算元素的几何属性，将其安放在界面中的正确位置，这个过程叫做重排。表现为重新生成布局，重新排列元素。

> 重排：重新生成布局，重新排列元素

* 重绘(Repaint): 当一个元素的外观发生改变，但没有改变布局，重新把元素外观绘制出来的过程，叫做重绘。表现为某些元素的外观被改变

> 重绘：某些元素的外观被改变，例如：元素的填充颜色

> 『重绘』不一定会出现『重排』，『重排』必然会出现『重绘』。

## 浏览器解析渲染机制

* 解析HTML，生成DOM树，解析CSS，生成CSSOM树
* 将DOM树和CSSOM树结合，生成渲染树(Render Tree)
* Layout(回流): 根据生成的渲染树，进行回流(Layout)，得到节点的几何信息（位置，大小）
* Painting(重绘): 根据渲染树以及回流得到的几何信息，得到节点的绝对像素
* Display: 将像素发送给GPU，展示在页面上

## 下面情况会发生重排

* 页面初始渲染，这是开销最大的一次重排
* 添加/删除可见的DOM元素
* 改变元素位置
* 改变元素尺寸，比如边距、填充、边框、宽度和高度等
* 改变元素内容，比如文字数量，图片大小等
* 改变元素字体大小
* 改变浏览器窗口尺寸，比如resize事件发生时

* 激活CSS伪类（例如：:hover）
* 设置 style 属性的值，因为通过设置style属性改变结点样式的话，每一次设置都会触发一次reflow
* 查询某些属性或调用某些计算方法：offsetWidth、offsetHeight等

## 常见的引起重绘的属性

color、 border-style、visibility、background、box-shadow、border-radius

* 颜色的修改
* 文本方向的修改
* 阴影的修改

## 重排优化建议

* 减少重排范围
* 减少重排次数
* 将 DOM 离线
* 使用 absolute 或 fixed 脱离文档流
* 优化动画
